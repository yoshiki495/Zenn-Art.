---
title: "RESTful概要"
emoji: "🐱"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["RESTful"]
published: true
---

# RESTfulとは
- RESTの規約に従ったRESTらしいWebサービスのこと

# RESTとは
- REpresentational State Transferの略で、Webのアーキテクチャスタイル（設計思想）のひとつ
- Webの設計思想であるRESTの制約に従うことで、より良い設計に

# RESTのメリット
- 同じURLやパラメータの組み合わせからは、常に同じ結果が返されることが期待される
- システムの状態やセッションに依存しない
- アプリケーション中のリソースが、URIで示せる
- ステートレスにすることで、スケーラビリティが向上
- 統一インターフェース
- 標準的なデータフォーマット（XMLやJSON）を扱うことで、他システムとの連携が容易になる
- RESTに基づいたWebアプリでは、インターフェースが固定されている為、互換性の問題が発生しない

- 以下に詳細な説明を記載。

# RESTの仕組み
- パラメータを指定
- 特定のURLにHTTPでアクセス
- XMLで記述されたメッセージが返ってくる

# RESTの設計思想
## リソース指向
- Web上に存在するすべての情報はリソースである
- リソースは識別子（URI）を持つ
- URIを用いることで、プログラムはリソースが表現する情報にアクセスできる
- ディレクトリ構造に似たURLを定義

### リソース思考でのURL設計指針
実装依存のパス名を使用しない（cbi-bin,servletなど）
プログラミング言語依存の拡張りやパスを含めない（.pl, rb, do, jspなど）
メソッド名やセッションIPを含めない
リソースを表現する名詞であること
URIをシンプルにし、ユーザービリティが高まる

## 統一インターフェース
- URIで指し示されるリソースに、GETやPOSTなどのHTTPメソッドを適用する
- HTTP1.1ではGETやPOSTなど、8個のメソッドだけが定義されている
- 全てのWebシステムでURIとHTTPメソッドおいう同じインターフェースを利用する
- このスタイルのことを統一インターフェースという

### 代表的なHTTPのメソッドとその役割
| メソッド | 役割 | 
| :--- | :--- | 
| GET | リソースの取得（読み込み） | 
| POST |リソースの新規作成  |
| PUT |既存リソースの更新  |
| DELETE |リソースの削除  |
- 一番よく利用されるのはGETとPOST
    - HTMLのフォームで指定できるメソッドが、この2つだけに制限されているため
- GETでのアクセスはリソースの内容に影響を与えない
- 新しいURLを作成するときだけPOSTを使用する

## ステートレス（↔ステートフル）
- リクエストには、処理に必要な全ての情報を含む

### ステートフルの例
- 客（クライアント）、店員（サーバ）
- 店員：いらっしゃいませ。〇〇バーガーへようこそ
- 客：ハンバーガーセットをお願いします
- 店員：サイドメニューは何になさいますか？
- 客：ポテトで
- 店員：ドリンクは何になさいますか？
- 客：コーラで
- 店員：+50円でドリンクをLサイズにできますがいかがですか？
- 客：Mでいいです
- 店員：以上でよろしいですか？
- 客：はい
- 店員：かしこまりました

### ステートレスの例
- 客（クライアント）、店員（サーバ）
- 店員：いらっしゃいませ。〇〇バーガーへようこそ
- 客：ハンバーガーセットをお願いします
- 店員：サイドメニューは何になさいますか？
- 客：ハンバーガーセットをポテトでお願いします
- 店員：ドリンクは何になさいますか？
- 客：ハンバーガーセットをポテトとコーラでお願いします
- 店員：+50円でドリンクをLサイズにできますがいかがですか？
- 客：ハンバーガーセットをポテトとコーラ（M）でお願いします
- 店員：以上でよろしいですか？
- 客：ハンバーガーセットをポテトとコーラ（M）でお願いします。以上で
- 店員：かしこまりました

### ステートレスのメリット
- 複数のWebサーバ（比較的少数）で複数のクライアント（比較的多数）を同時に受け付けることができ、スケーラビリティを拡大しやすい
- ステートレスなサーバは、アプリケーション状態を覚える必要がないので、サーバ側のシステムは単純になる
- クライアントはどのサーバにリクエストを送っても構わない
    - 必要な情報は全てリクエストに含まれているから

ステートレスの場合
- 店員1：いらっしゃいませ。〇〇バーガーへようこそ
客：ハンバーガーセットをお願いします
- 店員2：サイドメニューは何になさいますか？
客：ハンバーガーセットをポテトでお願いします
- 店員3：ドリンクは何になさいますか？
客：ハンバーガーセットをポテトとコーラでお願いします
- 店員4：+50円でドリンクをLサイズにできますがいかがですか？
客：ハンバーガーセットをポテトとコーラ（M）でお願いします
- 店員5：以上でよろしいですか？
客：ハンバーガーセットをポテトとコーラ（M）でお願いします。以上で
- 店員6：かしこまりました

### ステートレスのデメリット
- パフォーマンスの低下
    - 送信するデータ量が多くなる
    - 認証など、サーバに負荷がかかる処理を繰り返す
- 通信エラーへの対処が重要
    - レスポンスがうまく受け取れなかった場合、リクエストを2重に受け付けてします
    - ステートフルであれば、すでにリクエストを受け付けたことを覚えている

# RESTfulなWebサービス
- Yahoo!
- Google
- facebook
- twitter
...